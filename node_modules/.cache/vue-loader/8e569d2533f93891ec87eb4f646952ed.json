{"remainingRequest":"/home/praful/aappp/OC_7-Build_a_Full-Stack_solution-main/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/praful/aappp/OC_7-Build_a_Full-Stack_solution-main/frontend/src/components/Account/DeleteAccount.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/praful/aappp/OC_7-Build_a_Full-Stack_solution-main/frontend/src/components/Account/DeleteAccount.vue","mtime":1624537514000},{"path":"/home/praful/aappp/OC_7-Build_a_Full-Stack_solution-main/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/praful/aappp/OC_7-Build_a_Full-Stack_solution-main/frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/praful/aappp/OC_7-Build_a_Full-Stack_solution-main/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/praful/aappp/OC_7-Build_a_Full-Stack_solution-main/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7IENvbXBvbmVudCwgVnVlLCBSZWYgfSBmcm9tICJ2dWUtcHJvcGVydHktZGVjb3JhdG9yIjsKaW1wb3J0IHsgZGVsZXRlVXNlciB9IGZyb20gIi4uLy4uL2hlbHBlcnMvdXNlci1nZXR0ZXIiOwoKQENvbXBvbmVudApleHBvcnQgZGVmYXVsdCBjbGFzcyBEZWxldGVBY2NvdW50IGV4dGVuZHMgVnVlIHsKICBAUmVmKCkgcmVhZG9ubHkgZGVsZXRlQWNjb3VudEZvcm1CdXR0b24hOiBIVE1MQnV0dG9uRWxlbWVudDsKICBAUmVmKCkgcmVhZG9ubHkgcGFzc3dvcmRJbnB1dCE6IEhUTUxJbnB1dEVsZW1lbnQ7CgogIGlzX2RlbGV0aW5nID0gZmFsc2U7CiAgcHJpdmF0ZSBwYXNzd29yZCA9ICIiOwogIHByaXZhdGUgZXJyb3IgPSAiIjsKCiAgb3BlbkRlbGV0aW5nRm9ybSgpOiB2b2lkIHsKICAgIHRoaXMuaXNfZGVsZXRpbmcgPSB0cnVlOwogICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gdGhpcy5wYXNzd29yZElucHV0LmZvY3VzKCkpOwogIH0KCiAgY2xvc2VEZWxldGluZ0Zvcm0oKTogdm9pZCB7CiAgICB0aGlzLmlzX2RlbGV0aW5nID0gZmFsc2U7CiAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB0aGlzLmRlbGV0ZUFjY291bnRGb3JtQnV0dG9uLmZvY3VzKCkpOwogIH0KCiAgZGVsZXRlQWNjb3VudCgpOiB2b2lkIHsKICAgIGRlbGV0ZVVzZXIodGhpcy4kc3RvcmUuc3RhdGUudXNlci5pZCwgdGhpcy5wYXNzd29yZCkKICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMucGFzc3dvcmQgPSAiIjsKICAgICAgICB0aGlzLmVycm9yID0gIiI7CgogICAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oInRva2VuIik7CiAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoIi9yZWdpc3RlciIpOwogICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJjbGVhclVzZXIiKTsKICAgICAgfSkKICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICB0aGlzLmVycm9yID0gZXJyLm1lc3NhZ2U7CiAgICAgIH0pOwogIH0KfQo="},{"version":3,"sources":["DeleteAccount.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DeleteAccount.vue","sourceRoot":"src/components/Account","sourcesContent":["<template>\n  <section>\n    <button\n      type=\"button\"\n      v-if=\"!is_deleting\"\n      v-on:click=\"openDeletingForm\"\n      class=\"button account-button\"\n      ref=\"deleteAccountFormButton\"\n    >\n      Supprimer le compte\n    </button>\n\n    <form v-else>\n      <label>\n        Entrez votre mot de passe :\n        <input type=\"password\" v-model=\"password\" class=\"connection-field\" ref=\"passwordInput\" />\n      </label>\n\n      <fieldset class=\"delete-account-buttons\">\n        <button type=\"button\" v-on:click=\"deleteAccount\" class=\"button\">\n          Confirmer la suppression du compte\n        </button>\n        <button\n          type=\"reset\"\n          v-on:click=\"closeDeletingForm\"\n          class=\"button cancel\"\n        >\n          Annuler\n        </button>\n      </fieldset>\n\n      <p>{{ error }}</p>\n    </form>\n  </section>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue, Ref } from \"vue-property-decorator\";\nimport { deleteUser } from \"../../helpers/user-getter\";\n\n@Component\nexport default class DeleteAccount extends Vue {\n  @Ref() readonly deleteAccountFormButton!: HTMLButtonElement;\n  @Ref() readonly passwordInput!: HTMLInputElement;\n\n  is_deleting = false;\n  private password = \"\";\n  private error = \"\";\n\n  openDeletingForm(): void {\n    this.is_deleting = true;\n    this.$nextTick(() => this.passwordInput.focus());\n  }\n\n  closeDeletingForm(): void {\n    this.is_deleting = false;\n    this.$nextTick(() => this.deleteAccountFormButton.focus());\n  }\n\n  deleteAccount(): void {\n    deleteUser(this.$store.state.user.id, this.password)\n      .then((res) => {\n        this.password = \"\";\n        this.error = \"\";\n\n        sessionStorage.removeItem(\"token\");\n        this.$router.replace(\"/register\");\n        this.$store.dispatch(\"clearUser\");\n      })\n      .catch((err) => {\n        this.error = err.message;\n      });\n  }\n}\n</script>\n"]}]}